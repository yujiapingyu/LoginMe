# LoginMe - ユーザーログインシステム

FastAPIとReactに基づいたフルスタックユーザー認証システムで、ユーザー登録、ログイン、およびJWTトークン認証機能を実装しています。

体験ページ：[デモサイト](https://www.google.com/search?q=https://japanesetalk.org/login "null")

## 1. 環境要件

### バックエンド環境

- **Python**: 3.12 またはそれ以上のバージョン
    
- **データベース**: SQLite
    
- **主な依存パッケージ**:
    
    - FastAPI 0.124.0
        
    - SQLAlchemy 2.0.44
        
    - python-jose 3.5.0（JWT処理）
        
    - passlib 1.7.4（パスワード暗号化）
        
    - uvicorn 0.38.0（ASGIサーバー）
        

### フロントエンド環境

- **Node.js**: 25.1.0 またはそれ以上のバージョン
    
- **パッケージマネージャー**: npm
    
- **主な依存パッケージ**:
    
    - React 19.2.0
        
    - React Router DOM 7.10.1
        
    - Axios 1.13.2
        
    - Vite 7.2.4（ビルドツール）
        

## 2. 起動手順

### 1. バックエンドの起動

```
# バックエンドディレクトリに移動
cd backend

# 仮想環境を作成
python3 -m venv .venv
source .venv/bin/activate  # macOS/Linux
# または venv\Scripts\activate  # Windows

# 依存関係をインストール
pip install -r requirements.txt

# envファイルをコピー
cp .env.template .env
# コピー後、必要に応じて.env内の環境変数を修正してください

# バックエンドサーバーを起動（開発モード、自動リロード）
uvicorn main:app --reload

# バックエンドサーバーの動作URL: [http://127.0.0.1:8000](http://127.0.0.1:8000)
# APIドキュメントのアドレス: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
```

### 2. フロントエンドの起動

```
# フロントエンドディレクトリに移動
cd frontend

# 依存関係をインストール
npm install

# envファイルをコピー
cp .env.template .env
# コピー後、必要に応じて.env内の環境変数を修正してください

# 開発サーバーを起動
npm run dev

# フロントエンドサービスの動作URL: http://localhost:5173
```

### 3. アプリへのアクセス

ブラウザを開き、`http://localhost:5173` にアクセスしてアプリケーションを使用します。

## 3. 生成AIの使用箇所

本プロジェクトでは、以下の面で生成AIを活用し開発を支援しました：

### 1. **コード構造設計**

- プロジェクト全体のアーキテクチャ計画の支援
    
- バックエンドAPIエンドポイントの設計とRESTful仕様の確認
    
- フロントエンドのルーティング構造とコンポーネント分割の提案
    

### 2. **コード実装**

- **バックエンド**:
    
    - JWTトークンの生成と検証ロジック（`create_access_token`、`get_current_user`関数）
        
    - パスワードの暗号化と検証メカニズム（bcryptを使用）
        
    - データベースモデルとPydanticスキーマの定義
        
- **フロントエンド**:
    
    - React Routerの設定とルート保護ロジック
        
    - APIクライアントのラップ（axios設定）
        
    - フォームバリデーションとエラーハンドリング
        

### 3. **コード最適化**

- Python 3.12+のベストプラクティスに合わせるため、`datetime.utcnow()`から`datetime.now(timezone.utc)`へ移行
    
- 環境変数設定の最適化（dotenvを使用）
    
- コードコメントとドキュメント生成
    

### 4. **デバッグとトラブルシューティング**

- JWTトークンの有効期限処理に関する問題の調査
    
- CORS設定の問題解決
    
- データベース接続とセッション管理の最適化
    

### 5. **ドキュメント**

- ドキュメントの多言語翻訳
    

## 4. 簡易設計説明

### インタラクションフローの確定

```
1. ユーザー登録フロー:
   ユーザーがフォーム入力 → フロントエンド検証 → POST /api/register → バックエンドでメールアドレスの一意性検証 
   → パスワードハッシュ化 → データベースへ保存 → ユーザー情報を返す

2. ユーザーログインフロー:
   ユーザーがフォーム入力 → フロントエンド検証 → POST /api/login → バックエンドでメールアドレスとパスワードを検証
   → JWTトークン生成 → access_tokenを返す → フロントエンドでトークンを保存

3. 保護されたリソースへのアクセス:
   フロントエンドからのリクエスト → JWTトークンを付与（Authorization: Bearer <token>）
   → バックエンドでトークン検証 → ユーザーデータまたは401エラーを返す
```

### バックエンド設計

#### 技術スタック

- **フレームワーク**: FastAPI - モダンで高速なPython Webフレームワーク。非同期処理と自動APIドキュメントをサポート
    
- **ORM**: SQLAlchemy - 強力なPython SQLツールキットおよびオブジェクト関係マッピング
    
- **認証**: JWT (JSON Web Token) - ステートレスなトークン認証メカニズム
    
- **パスワード暗号化**: Bcrypt - 業界標準のパスワードハッシュアルゴリズム
    
- **データ検証**: Pydantic - Pythonの型ヒントに基づいたデータ検証
    

#### データベース設計

```
User テーブル:
- id: Integer (主キー)
- email: String (ユニーク, インデックス)
- hashed_password: String (BCrypt暗号化済み)
```

#### APIインターフェース設計

|エンドポイント|メソッド|機能|認証要否|
|---|---|---|---|
|`/api/register`|POST|ユーザー登録|否|
|`/api/login`|POST|ユーザーログイン|否|
|`/api/users/me`|GET|現在のユーザー情報を取得|要（JWT）|

**詳細インターフェース説明:**

1. **POST /api/register**
    
    - リクエストボディ: `{ "email": "user@example.com", "password": "password123" }`
        
    - レスポンス: `{ "id": 1, "email": "user@example.com" }`
        
    - エラー: 400 - メールアドレス登録済み
        
2. **POST /api/login**
    
    - リクエストボディ: `{ "email": "user@example.com", "password": "password123" }`
        
    - レスポンス: `{ "access_token": "eyJ...", "token_type": "bearer" }`
        
    - エラー: 400 - ユーザーが存在しないか、パスワードが間違っています
        
3. **GET /api/users/me**
    
    - リクエストヘッダー: `Authorization: Bearer <token>`
        
    - レスポンス: `{ "id": 1, "email": "user@example.com" }`
        
    - エラー: 401 - 未認証（Unauthorized）
        

#### セキュリティメカニズム

- **パスワードの安全性**: Bcryptアルゴリズムを使用してパスワードをハッシュ化し、平文のパスワードは決して保存しません
    
- **トークンの有効期限**: JWTトークンはデフォルトで30分で期限切れとなります（環境変数で設定可能）
    
- **トークン検証**: 保護されたリソースへのリクエストごとに、トークンの署名と有効期限を検証します
    
- **依存性の注入**: FastAPIの依存性注入システムを使用して認証ガードを実装しています
    

### フロントエンド設計

#### 技術スタック

- **フレームワーク**: React 19.2.0 - モダンなUIライブラリ
    
- **ルーティング**: React Router DOM 7.10.1 - クライアントサイドのルーティング管理
    
- **HTTPクライアント**: Axios - APIリクエストとレスポンスの処理
    
- **ビルドツール**: Vite - 高速なフロントエンドビルドツール
    

#### ページ構成

```
/login       → ログインページ
/register    → 登録ページ
/            → トップページ（保護対象、ログインが必要）
```

#### コンポーネント設計

- **LoginPage**: ログインフォーム、ユーザーのログインロジックを処理
    
- **RegisterPage**: 登録フォーム、ユーザーの登録ロジックを処理
    
- **HomePage**: 保護されたホームページ、ユーザー情報を表示
    

#### 状態管理

- `localStorage`を使用してJWTトークンを保存
    
- `axios`インターセプターにより、リクエストヘッダーに認証トークンを自動的に追加
    
- 401エラー発生時に自動的にログインページへリダイレクト